<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Url shortener</title>
</head>
<body>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <div class="container">
        <h5 class="card-header">URL ë‹¨ì¶• ìƒì„±ê¸° ğŸ˜€</h5>
        <p>ë‹¨ì¶•í•˜ê³  ì‹¶ì€ URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”. (httpë¥¼ í¬í•¨í•´ì£¼ì„¸ìš”!)</p>
        <p>ex. http://localhost/user, https://www.onstove.com/</p>
        <form>
            <div class="col-12">
                <input id="input" placeholder="URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”" type="text" size="50">
                <button type="button" onclick="makeShortenUrl()">shorten</button>
            </div>
            <br/>
            <div id="result">
            </div>
       </form>
    </div>
</body>
<script>
    makeShortenUrl = () => {
        const targetUrl = document.getElementById("input").value;
        const CreateUrlDtoRequest = { targetUrl: targetUrl };
        $.ajax({
            url: "/api/url",
            contentType: "application/json",
            data: JSON.stringify(CreateUrlDtoRequest),
            type:"POST",
            error : function(error) {
                alert("ìš”ì²­ ì¤‘ ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
            },
            success : function(data) {
                if (data.status >= 400) {
                    document.getElementById("result").innerText = data.errorMessage;
                } else {
                    document.getElementById("result").innerText = data.shorten;
                }

            }
        });
    }
</script>
</html>